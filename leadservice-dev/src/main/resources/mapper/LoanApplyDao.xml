<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.shenhua119.leadservice.dao.LoanApplyDao">

    <resultMap id="loanApplyMapsLazyLoading" type="com.shenhua119.leadservice.entity.LoanApplyEntity" >
        <id column="id" property="id"/>
        <result column="p_id" property="pId"/>
        <result column="project_name" property="projectName"/>
        <result column="loan_no" property="loanNo"/>
        <result column="name" property="name"/>
        <result column="loan_date" property="loanDate"/>
        <result column="loan_amount" property="loanAmount"/>
        <result column="loan_cycle" property="loanCycle"/>
        <result column="f_id" property="fId"/>
        <result column="com_id" property="comId"/>
        <result column="f_com_id" property="fComId"/>
        <result column="com_id" property="comId"/>
        <result column="status" property="status"/>
        <collection property="purchaseOrders" ofType="com.shenhua119.leadservice.entity.ProjectPurchaseOrderEntity" column="loan_no" select="selectProjectPurchaseOrderById">
        </collection>
    </resultMap>

    <select id="selectByFinancierId" parameterType="long" resultMap="loanApplyMapsLazyLoading">
		select
			tb1.*, tb2.name,tb3.project_name
		from tb_loan_apply tb1
        left join tb_financier tb2 on tb1.f_id = tb2.id
        left join tb_project tb3 on tb1.p_id = tb3.id
		where tb1.f_id = #{id}
	</select>

    <select id="selectByEngCompanyId" parameterType="long" resultMap="loanApplyMapsLazyLoading">
		select
			tb1.*, tb2.name,tb3.project_name
		from tb_loan_apply tb1
        left join tb_financier tb2 on tb1.f_id = tb2.id
        left join tb_project tb3 on tb1.p_id = tb3.id
		where tb1.com_id = #{id}
	</select>

    <select id="selectByFundCompanyId" parameterType="long" resultMap="loanApplyMapsLazyLoading">
		select
			tb1.*, tb2.name,tb3.project_name
		from tb_loan_apply tb1
        left join tb_financier tb2 on tb1.f_id = tb2.id
        left join tb_project tb3 on tb1.p_id = tb3.id
		where tb1.f_com_id = #{id}
	</select>

    <select id="selectAll2" parameterType="long" resultMap="loanApplyMapsLazyLoading">
		select
			tb1.*, tb2.name,tb3.project_name
		from tb_loan_apply tb1
        left join tb_financier tb2 on tb1.f_id = tb2.id
        left join tb_project tb3 on tb1.p_id = tb3.id
	</select>

    <select id="selectProjectPurchaseOrderById" parameterType="long" resultType="com.shenhua119.leadservice.entity.ProjectPurchaseOrderEntity">
		select
			ppo.*
		from tb_project_purchase_order ppo
		where loan_no = #{loan_no}
	</select>

</mapper>